"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[228],{4850:(F,C,l)=>{l.r(C),l.d(C,{HomeComponent:()=>W});var m=l(177),c=l(467),e=l(4438),M=l(9132),_=l(1517),g=l(7927),f=l(4441),u=l(5889);function h(o,s){if(1&o){const a=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"h3",4),e.EFF(3," Completa tu perfil "),e.k0s(),e.j41(4,"button",5),e.bIt("click",function(){e.eBV(a);const n=e.XpG();return e.Njj(n.closeModal())}),e.EFF(5,"\xd7"),e.k0s()(),e.j41(6,"div",6)(7,"div",7)(8,"app-user-info-form",8),e.bIt("userInfo",function(n){e.eBV(a);const i=e.XpG();return e.Njj(i.onUserInfoUpdate(n))})("cancelClicked",function(){e.eBV(a);const n=e.XpG();return e.Njj(n.closeModal())}),e.k0s()(),e.nrm(9,"div",9),e.k0s()()}if(2&o){const a=e.XpG();e.R7$(8),e.Y8G("isEditable",!a.inputsEditable)}}function A(o,s){1&o&&e.nrm(0,"app-spinner")}let S=(()=>{var o;class s{constructor(t,n,i){this._userService=t,this._authService=n,this._toastService=i,this.showModal=!1,this.closed=new e.bkB,this.isLoaded=!1,this.inputsEditable=!1,this.user={}}ngOnInit(){var t=this;return(0,c.A)(function*(){yield t._authService.getCurrentUser().then(n=>{t.user=n,t.isLoaded=!0})})()}onUserInfoUpdate(t){t.role=this.user.role,this.isLoaded=!1,this._userService.updateUserDB(t,this.user.uid).then(n=>{n.error&&this._toastService.showError("Error al actualizar la informaci\xf3n"),this.isLoaded=!0,this._toastService.showSuccess("Datos actualizados correctamente"),this.closeModal()})}closeModal(){this.closed.emit()}}return(o=s).\u0275fac=function(t){return new(t||o)(e.rXU(g.D),e.rXU(f.u),e.rXU(u.f))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-modal"]],inputs:{showModal:"showModal"},outputs:{closed:"closed"},standalone:!0,features:[e.aNF],decls:4,vars:1,consts:[[1,"modal"],[1,"modal-overlay",3,"click"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title","card-title"],[1,"modal-close",3,"click"],[1,"modal-body"],[1,"modal-form"],[3,"userInfo","cancelClicked","isEditable"],[1,"modal-map"]],template:function(t,n){1&t&&(e.j41(0,"div",0)(1,"div",1),e.bIt("click",function(){return n.closeModal()}),e.k0s(),e.DNE(2,h,10,1,"div",2)(3,A,1,0),e.k0s()),2&t&&(e.R7$(2),e.vxM(2,n.isLoaded?2:3))},dependencies:[M.l,_.t],styles:[".modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background-color:#00000080;z-index:1000}.modal-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:transparent}.modal-content[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 8px #00000026;max-width:-moz-fit-content;max-width:fit-content;max-height:-moz-fit-content;max-height:fit-content}.modal-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.modal-title[_ngcontent-%COMP%]{margin:unset;font-size:1rem}.modal-close[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer}@media screen and (max-width: 1150px){.modal[_ngcontent-%COMP%]{background-color:#fff}.modal-overlay[_ngcontent-%COMP%]{display:none}.modal-content[_ngcontent-%COMP%]{border-radius:0;box-shadow:unset;gap:15px;max-height:unset;height:87vh}.modal-body[_ngcontent-%COMP%]{overflow-y:scroll}.modal-body[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.modal-body[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.modal-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:transparent}.modal-close[_ngcontent-%COMP%]{display:none}}@media (orientation: landscape) and (max-height: 412px){.modal-content[_ngcontent-%COMP%]{height:69vh}}"]}),s})();var y=l(6114),I=l(7926);function v(o,s){return(0,I.z)(o,-s)}var b=l(5875),O=l(9417),x=l(1667),P=l(1417),T=l(4192),w=l(2575),D=l(7595),k=l(2185);function j(o,s){if(1&o){const a=e.RV6();e.j41(0,"li")(1,"div",24)(2,"div",25),e.bIt("click",function(){const n=e.eBV(a).$implicit,i=e.XpG(2);return e.Njj(i.onAppointmentClicked(n))}),e.j41(3,"div",26)(4,"div",27)(5,"label",28),e.EFF(6,"Nombre:"),e.k0s(),e.j41(7,"span"),e.EFF(8),e.k0s()(),e.j41(9,"div",29)(10,"label",30),e.EFF(11,"Ubicaci\xf3n:"),e.k0s(),e.j41(12,"span"),e.EFF(13),e.k0s()()(),e.j41(14,"div",31)(15,"div",32)(16,"label",33),e.EFF(17,"D\xeda:"),e.k0s(),e.j41(18,"span"),e.EFF(19),e.nI1(20,"date"),e.nI1(21,"titlecase"),e.k0s()(),e.j41(22,"div",34)(23,"label",35),e.EFF(24,"Hora:"),e.k0s(),e.j41(25,"span"),e.EFF(26),e.nI1(27,"date"),e.k0s()()()(),e.j41(28,"div",36)(29,"button",37),e.bIt("click",function(){const n=e.eBV(a).$implicit,i=e.XpG(2);return e.Njj(i.onOpenDeleteDialog(n))}),e.nrm(30,"img",38),e.k0s()()()()}if(2&o){const a=s.$implicit;e.R7$(8),e.Lme("",a.patient.name," ",a.patient.lastname,""),e.R7$(5),e.JRh(a.shortAddress),e.R7$(6),e.JRh(e.bMT(21,8,e.i5U(20,5,a.datetime,"EEEE, MMMM d, y"))),e.R7$(7),e.JRh(e.brH(27,10,a.datetime,"h:mm a","UTC+0"))}}function E(o,s){if(1&o&&e.Z7z(0,j,31,14,"li",null,e.fX1),2&o){const a=e.XpG();e.Dyx(a.appointments)}}function U(o,s){1&o&&(e.j41(0,"li")(1,"div",24),e.EFF(2," No se encontraron resultados "),e.k0s()())}let R=(()=>{var o;class s{constructor(t,n,i,r){var d,p;this.appointmentService=t,this.toastService=n,this.userService=i,this.router=r,this.sidebarVisible=!1,this.rangeDates=[],this.selectedDates={startDate:"",endDate:""},this.showClear=!1,this.appointments=[],this.originalAppointments=[],this.searchTerm="",this.userId="",this.user={},this.appointment={},this.isDialogOpen=!1,this.userId=null!==(d=null===(p=(0,y.xI)().currentUser)||void 0===p?void 0:p.uid)&&void 0!==d?d:""}ngOnInit(){this.getUser().then(()=>{this.user?this.getAppointments():this.router.navigate(["/not-found"])})}ngOnDestroy(){this.appointments=[],this.user={},this.userId="",this.searchTerm="",this.originalAppointments=[]}getUser(){var t=this;return(0,c.A)(function*(){if(!t.userId)return;const n=yield t.userService.getUserById(t.userId);n.success?t.user=n.data:console.error("User not found")})()}getAppointments(){var t=this;return(0,c.A)(function*(){try{const n="admin"==t.user.role?yield t.appointmentService.getAppointmentsByDoctor(t.userId):yield t.appointmentService.getAppointmentsByPatient(t.userId);if(n.success){const i=/([A-Z]{2}|[A-Z]{1}[0-9]{1}),\s(.*)/;t.appointments=n.data.reduce((r,d)=>{if(t.isTodayAndUpcoming(d)){const p=t.extractShortAddress(d.location.address,i);r.push({...d,shortAddress:p})}return r},[]).sort((r,d)=>new Date(r.datetime).getTime()-new Date(d.datetime).getTime()),t.originalAppointments=[...t.appointments]}}catch(n){console.error(n)}})()}extractShortAddress(t,n){const i=null==t?void 0:t.match(n);return i?i[2]:t}isTodayAndUpcoming(t){return t.datetime.split("T")[0]>=v((new Date).toISOString(),(new Date).getTimezoneOffset()).toISOString().split("T")[0]}onSearchInputChange(t){this.appointments=t?this.originalAppointments.filter(n=>n.patient.name.toLowerCase().includes(t.toLowerCase())||n.patient.lastname.toLowerCase().includes(t.toLowerCase())||n.shortAddress.toLowerCase().includes(t.toLowerCase())):[...this.originalAppointments]}onOpenDeleteDialog(t){this.appointment=t,this.sidebarVisible=!1,this.isDialogOpen=!0}onCloseDialog(){this.isDialogOpen=!1,this.sidebarVisible=!1}onDeleteAppointment(t){var n=this;return(0,c.A)(function*(){if(!t)return;const i=yield n.appointmentService.deleteAppointmentEv(t);null!=i&&i.success?(n.toastService.showSuccess("Su cita ha sido eliminada correctamente"),n.getAppointments()):n.toastService.showError("Error al eliminar la cita"),n.onCloseDialog()})()}onAppointmentClicked(t){t&&(this.sidebarVisible=!0,this.selectedAppointment=t)}onDateRangeChange(t){if(t){let n=t;""!=this.selectedDates.startDate&&""!=this.selectedDates.endDate&&this.clearDateRange(),""==this.selectedDates.startDate&&""==this.selectedDates.endDate&&(this.singleDateSelected(n),this.showClear=!0),""!=this.selectedDates.startDate&&""==this.selectedDates.endDate&&(this.selectedDates.startDate<n.toISOString().split("T")[0]?(this.rangeDateSelected(n),this.showClear=!0):(this.clearDateRange(),this.singleDateSelected(n),this.showClear=!0))}else this.appointments=[...this.originalAppointments]}onClearRangeSearch(){this.clearDateRange(),this.appointments=[...this.originalAppointments]}clearDateRange(){this.selectedDates.startDate="",this.selectedDates.endDate=""}singleDateSelected(t){this.selectedDates.startDate=t.toISOString().split("T")[0],this.appointments=this.originalAppointments.filter(n=>new Date(n.datetime).toISOString().split("T")[0]===this.selectedDates.startDate)}rangeDateSelected(t){this.selectedDates.endDate=t.toISOString().split("T")[0],this.appointments=this.originalAppointments.filter(n=>{let i=new Date(n.datetime).toISOString().split("T")[0];return i>=this.selectedDates.startDate&&i<=this.selectedDates.endDate})}onCreateNewAppointment(){this.router.navigate(["/agenda/new-event",(new Date).getTime()])}}return(o=s).\u0275fac=function(t){return new(t||o)(e.rXU(D.h),e.rXU(u.f),e.rXU(g.D),e.rXU(k.Ix))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-appointment-filter"]],standalone:!0,features:[e.aNF],decls:40,vars:8,consts:[[1,"widget_container"],[1,"card-headline"],[1,"search-section"],[1,"filter"],[3,"searchInputChange","placeholder"],[1,"dates"],[1,"card","flex","justify-content-center"],["selectionMode","range",1,"date-range",3,"ngModelChange","onSelect","onClear","ngModel","showClear","readonlyInput"],[1,"new-appointment"],[1,"btn","new-appointment-btn",3,"click"],["src","/assets/icon/plus_icon.svg","alt","plus sign",1,"plus-btn-icon"],[1,"new-appointment-btn-label"],[1,"card-body"],[1,"card-body-headline","mb-5"],[1,"card-body-results"],[1,"delete-dialog",3,"closeDialog","isOpen"],["dialog-header",""],["dialog-body",""],[1,"content-body"],[1,"dialog-actions"],[1,"btn","cancel-btn",3,"click"],[1,"btn","confirm-btn",3,"click"],["position","right","styleClass","custom-sidebar","closeOnEscape","true",3,"visibleChange","visible"],[3,"onDeleteAppointment","selectedAppointment"],[1,"card-body-results-item"],[1,"clickable-section",3,"click"],[1,"first-section"],[1,"name"],["for","name"],[1,"location"],["for","location"],[1,"second-section"],[1,"date"],["for","date"],[1,"hour"],["for","hour"],[1,"actions-section"],[1,"btn","delete-btn",3,"click"],["src","/assets/icon/wastebasket.svg","alt","delete-wastebasket"]],template:function(t,n){1&t&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),e.EFF(5,"Buscar citas"),e.k0s(),e.j41(6,"app-search-input",4),e.bIt("searchInputChange",function(r){return n.onSearchInputChange(r)}),e.k0s()(),e.j41(7,"div",5)(8,"h2"),e.EFF(9,"Fechas"),e.k0s(),e.j41(10,"div",6)(11,"p-calendar",7),e.mxI("ngModelChange",function(r){return e.DH7(n.rangeDates,r)||(n.rangeDates=r),r}),e.bIt("onSelect",function(r){return n.onDateRangeChange(r)})("onClear",function(){return n.onClearRangeSearch()}),e.k0s()()(),e.j41(12,"div",8)(13,"button",9),e.bIt("click",function(){return n.onCreateNewAppointment()}),e.nrm(14,"img",10),e.j41(15,"span",11),e.EFF(16,"Nueva cita"),e.k0s()()()()(),e.j41(17,"div",12)(18,"div",13)(19,"h2"),e.EFF(20,"Resultados de B\xfasqueda"),e.k0s()(),e.j41(21,"div",14)(22,"ul"),e.DNE(23,E,2,0)(24,U,3,0),e.k0s(),e.j41(25,"app-dialog",15),e.bIt("closeDialog",function(){return n.isDialogOpen=!1}),e.j41(26,"div",16)(27,"h2"),e.EFF(28,"Eliminar cita"),e.k0s()(),e.j41(29,"div",17)(30,"div",18)(31,"p"),e.EFF(32,"\xbfEst\xe1s seguro que deseas eliminar la cita agendada?"),e.k0s()(),e.j41(33,"div",19)(34,"button",20),e.bIt("click",function(){return n.isDialogOpen=!1}),e.EFF(35,"Cancelar"),e.k0s(),e.j41(36,"button",21),e.bIt("click",function(){return n.onDeleteAppointment(n.appointment)}),e.EFF(37,"Eliminar"),e.k0s()()()(),e.j41(38,"p-sidebar",22),e.mxI("visibleChange",function(r){return e.DH7(n.sidebarVisible,r)||(n.sidebarVisible=r),r}),e.j41(39,"app-sidebar",23),e.bIt("onDeleteAppointment",function(r){return n.onOpenDeleteDialog(r)}),e.k0s()()()()()),2&t&&(e.R7$(6),e.Y8G("placeholder","Nombre, apellido, ubicaci\xf3n..."),e.R7$(5),e.FS9("showClear",n.showClear),e.R50("ngModel",n.rangeDates),e.Y8G("readonlyInput",!0),e.R7$(12),e.vxM(23,n.appointments.length>0?23:24),e.R7$(2),e.Y8G("isOpen",n.isDialogOpen),e.R7$(13),e.R50("visible",n.sidebarVisible),e.R7$(),e.Y8G("selectedAppointment",n.selectedAppointment))},dependencies:[T.i,m.MD,m.PV,m.vh,b.n,b.B,P.k,O.YN,O.BC,O.vS,x.rO,x.Vv,w.m],styles:[".widget_container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;align-content:center;justify-content:center;flex-wrap:wrap;width:100%;height:calc(100vh - 64px);left:1rem;gap:1.25rem}.card-headline[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]{display:flex;background-color:var(--white);padding:20px;box-shadow:0 .25rem .75rem #0d0a2c0f;border:solid 1px var(--border-gray);max-width:68rem}.card-body[_ngcontent-%COMP%]{flex-direction:column;padding:3rem;font-size:1rem;color:var(--dark-gray);width:85%;overflow:auto;border-radius:0 0 1rem 1rem;height:30.75rem}.card-headline[_ngcontent-%COMP%]{border-radius:16px 16px 0 0;gap:1rem}.card-headline[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around;gap:1rem;width:100%}.card-headline[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%], .card-headline[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .dates[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:1rem}.card-headline[_ngcontent-%COMP%]   .new-appointment[_ngcontent-%COMP%]   .btn.new-appointment-btn[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;width:auto;padding:6px 16px;border-radius:2rem;font-weight:700;background-color:var(--dark-blue);color:#fff;transition:all .15s ease 0s}.card-headline[_ngcontent-%COMP%]   .new-appointment[_ngcontent-%COMP%]   .btn.new-appointment-btn[_ngcontent-%COMP%]   .plus-btn-icon[_ngcontent-%COMP%]{width:1rem;height:1rem;margin-right:.5rem}.card-headline[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .card-body-headline[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:700;color:var(--dark-gray)}.card-body-headline[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1rem}.card-body[_ngcontent-%COMP%]::-webkit-scrollbar{width:.25rem}.card-body[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:1rem}.card-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--dark-blue);border-radius:1rem}.card-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--darker-blue)}[_nghost-%COMP%]     .p-sidebar-active{width:50%;top:4rem}[_nghost-%COMP%]     .map-panel.p-panel .p-panel-content{padding:0}[_nghost-%COMP%]     .overlay.p-blockui{border-radius:1rem;width:25rem!important;height:15.625rem}[_nghost-%COMP%]     .date-range.p-element .p-inputtext{border:1px solid var(--light-gray);border-radius:1rem;width:100%;height:2.25rem;font-size:.87rem;box-sizing:border-box;padding:0 3rem 0 1rem}.card-body-results[_ngcontent-%COMP%], .card-body-results[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.card-body-results-item[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:1rem;border-radius:1rem;box-shadow:0 2px 8px #00000026;background-color:#fff;height:-moz-fit-content;height:fit-content}.card-body-results-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:inherit;line-height:normal}.clickable-section[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex:1rem;cursor:pointer}.card-body-results-item[_ngcontent-%COMP%]   .clickable-section[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.card-body-results-item[_ngcontent-%COMP%]   .clickable-section[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:flex-start}.first-section[_ngcontent-%COMP%]{flex:1.5}.first-section[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{max-width:14rem}.second-section[_ngcontent-%COMP%]{flex:1}.actions-section[_ngcontent-%COMP%]{display:flex;flex:.5;gap:1rem;align-items:flex-end;flex-direction:column}button.btn[_ngcontent-%COMP%]{color:var(--white);padding:.25rem;border-radius:.25rem;box-shadow:0 0 .25rem #00000026;cursor:pointer}button.btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1rem;height:1rem}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:.5rem 1rem;margin-top:1rem;border-radius:.25rem;cursor:pointer;box-shadow:0 0 .25rem #00000026;font-weight:700}.dialog-actions[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]{background-color:var(--white);color:var(--dark-blue);border:1px solid var(--dark-blue)}.dialog-actions[_ngcontent-%COMP%]   .confirm-btn[_ngcontent-%COMP%]{background-color:#f87171;color:var(--white)}.delete-dialog[_ngcontent-%COMP%]{position:fixed;z-index:1300}@media screen and (max-width: 1150px){.widget_container[_ngcontent-%COMP%]{display:flex;left:0;flex-direction:column;gap:1.25rem;width:100%;height:100%;flex-wrap:wrap;justify-content:flex-start;flex:1 1 auto}.card-body[_ngcontent-%COMP%]{width:90%}}@media screen and (max-width: 1000px){[_nghost-%COMP%]     .p-sidebar-active{width:70%;height:calc(100vh - 8rem)}.new-appointment[_ngcontent-%COMP%]{position:fixed;bottom:4.688rem;align-self:flex-end}.new-appointment[_ngcontent-%COMP%]   .btn.new-appointment-btn[_ngcontent-%COMP%]{padding:8px 16px}}@media screen and (max-width: 768px){.card-headline[_ngcontent-%COMP%]{box-shadow:none;border:none;flex-direction:column;align-items:flex-start;padding:0rem 2rem}.card-headline[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]{width:100%;flex-direction:column;justify-content:flex-start}.card-headline[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]{gap:.5rem;flex-direction:column;align-items:flex-start}.card-headline[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]   app-search-input[_ngcontent-%COMP%]{width:21.5rem}.card-headline[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .dates[_ngcontent-%COMP%]{gap:.5rem;flex-direction:column;align-items:flex-start}[_nghost-%COMP%]     .date-range.p-element .p-inputtext{width:21.5rem}.card-body[_ngcontent-%COMP%]{box-shadow:none;border:none;width:100%;padding:0rem 2rem 8rem;flex:1 1 auto}.card-body-results-item[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem;height:15rem}.clickable-section[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.card-body-results-item[_ngcontent-%COMP%]   .actions-section[_ngcontent-%COMP%]{flex-direction:row;justify-content:flex-end}.first-section[_ngcontent-%COMP%]{flex:1}}@media screen and (max-width: 600px){[_nghost-%COMP%]     .p-sidebar-active{width:100%}}"]}),s})();function V(o,s){if(1&o){const a=e.RV6();e.j41(0,"li")(1,"div",13)(2,"div",14),e.bIt("click",function(){const n=e.eBV(a).$implicit,i=e.XpG(2);return e.Njj(i.onAppointmentClicked(n))}),e.j41(3,"p"),e.EFF(4),e.k0s(),e.j41(5,"p"),e.EFF(6),e.k0s(),e.j41(7,"p"),e.EFF(8),e.nI1(9,"date"),e.nI1(10,"titlecase"),e.k0s(),e.j41(11,"p"),e.EFF(12),e.nI1(13,"date"),e.k0s()(),e.j41(14,"div",15)(15,"button",16),e.bIt("click",function(){const n=e.eBV(a).$implicit,i=e.XpG(2);return e.Njj(i.onOpenDeleteDialog(n))}),e.nrm(16,"img",17),e.k0s()()()()}if(2&o){const a=s.$implicit;e.R7$(4),e.Lme("Nombre: ",a.patient.name," ",a.patient.lastname,""),e.R7$(2),e.SpI("Ubicaci\xf3n: ",a.shortAddress,""),e.R7$(2),e.SpI("D\xeda: ",e.bMT(10,8,e.i5U(9,5,a.datetime,"EEEE, MMMM d, y")),""),e.R7$(4),e.SpI("Hora: ",e.brH(13,10,a.datetime,"h:mm a","UTC+0"),"")}}function B(o,s){if(1&o&&e.Z7z(0,V,17,14,"li",null,e.fX1),2&o){const a=e.XpG();e.Dyx(a.appointments)}}function N(o,s){1&o&&(e.j41(0,"li")(1,"div",13)(2,"div",18)(3,"p"),e.EFF(4,"No hay citas agendadas para hoy"),e.k0s()()()())}let $=(()=>{var o;class s{constructor(t,n,i,r){var d,p;this.appointmentService=t,this.userService=n,this.router=i,this.toastService=r,this.sidebarVisible=!1,this.isDialogOpen=!1,this.appointments=[],this.userId="",this.user={},this.appointment={},this.userId=null!==(d=null===(p=(0,y.xI)().currentUser)||void 0===p?void 0:p.uid)&&void 0!==d?d:""}ngOnInit(){this.getUser().then(()=>{this.user?this.getAppointments():this.router.navigate(["/not-found"])})}ngOnDestroy(){this.appointments=[],this.user={},this.userId="",this.sidebarVisible=!1}getUser(){var t=this;return(0,c.A)(function*(){if(!t.userId)return;const n=yield t.userService.getUserById(t.userId);n.success&&(t.user=n.data)})()}getAppointments(){var t=this;return(0,c.A)(function*(){try{const n=yield t.appointmentService.getAppointmentsByDoctor(t.userId);if(n.success){const i=/([A-Z]{2}|[A-Z]{1}[0-9]{1}),\s(.*)/;t.appointments=n.data.reduce((r,d)=>{if(t.isTodayAndUpcoming(d)){const p=t.extractShortAddress(d.location.address,i);r.push({...d,shortAddress:p})}return r},[]).sort((r,d)=>new Date(r.datetime).getTime()-new Date(d.datetime).getTime())}}catch(n){console.error(n)}})()}extractShortAddress(t,n){const i=null==t?void 0:t.match(n);return i?i[2]:t}isTodayAndUpcoming(t){const n=t.datetime.split("T")[0],i=t.datetime.split("T")[1].split(".")[0],r=v((new Date).toISOString(),(new Date).getTimezoneOffset()).toISOString().split("T")[0],d=v((new Date).toISOString(),(new Date).getTimezoneOffset()).toISOString().split("T")[1].split(".")[0];return n===r&&i>=d}onAppointmentClicked(t){t&&(this.sidebarVisible=!0,this.selectedAppointment=t)}onOpenDeleteDialog(t){this.appointment=t,this.sidebarVisible=!1,this.isDialogOpen=!0}onCloseDialog(){this.isDialogOpen=!1,this.sidebarVisible=!1}onDeleteAppointment(t){var n=this;return(0,c.A)(function*(){if(!t)return;const i=yield n.appointmentService.deleteAppointmentEv(t);null!=i&&i.success?(n.toastService.showSuccess("Su cita ha sido eliminada correctamente"),n.getAppointments()):n.toastService.showError("Error al eliminar la cita"),n.onCloseDialog()})()}}return(o=s).\u0275fac=function(t){return new(t||o)(e.rXU(D.h),e.rXU(g.D),e.rXU(k.Ix),e.rXU(u.f))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-today-schedule-widget"]],standalone:!0,features:[e.aNF],decls:24,vars:4,consts:[[1,"schedule-widget-container"],[1,"card-headline"],[1,"card-body"],[1,"card-body-results"],[1,"delete-dialog",3,"closeDialog","isOpen"],["dialog-header",""],["dialog-body",""],[1,"content-body"],[1,"dialog-actions"],[1,"btn","cancel-btn",3,"click"],[1,"btn","confirm-btn",3,"click"],["position","right","styleClass","custom-sidebar","closeOnEscape","true",3,"visibleChange","visible"],[3,"onDeleteAppointment","selectedAppointment"],[1,"card-body-results-item"],[1,"result-item-body",3,"click"],[1,"result-body-buttons"],[1,"delete",3,"click"],["src","/assets/icon/trash-can-alt.svg","alt","delete"],[1,"result-item-body"]],template:function(t,n){1&t&&(e.j41(0,"div",0)(1,"div",1)(2,"h2"),e.EFF(3,"Pr\xf3ximas citas"),e.k0s()(),e.j41(4,"div",2)(5,"div",3)(6,"ul"),e.DNE(7,B,2,0)(8,N,5,0),e.k0s(),e.j41(9,"app-dialog",4),e.bIt("closeDialog",function(){return n.isDialogOpen=!1}),e.j41(10,"div",5)(11,"h2"),e.EFF(12,"Eliminar cita"),e.k0s()(),e.j41(13,"div",6)(14,"div",7)(15,"p"),e.EFF(16,"\xbfEst\xe1s seguro que deseas eliminar la cita agendada?"),e.k0s()(),e.j41(17,"div",8)(18,"button",9),e.bIt("click",function(){return n.isDialogOpen=!1}),e.EFF(19,"Cancelar"),e.k0s(),e.j41(20,"button",10),e.bIt("click",function(){return n.onDeleteAppointment(n.appointment)}),e.EFF(21,"Eliminar"),e.k0s()()()(),e.j41(22,"p-sidebar",11),e.mxI("visibleChange",function(r){return e.DH7(n.sidebarVisible,r)||(n.sidebarVisible=r),r}),e.j41(23,"app-sidebar",12),e.bIt("onDeleteAppointment",function(r){return n.onOpenDeleteDialog(r)}),e.k0s()()()()()),2&t&&(e.R7$(7),e.vxM(7,n.appointments.length>0?7:8),e.R7$(2),e.Y8G("isOpen",n.isDialogOpen),e.R7$(13),e.R50("visible",n.sidebarVisible),e.R7$(),e.Y8G("selectedAppointment",n.selectedAppointment))},dependencies:[m.MD,m.PV,m.vh,b.n,b.B,P.k,w.m],styles:[".schedule-widget-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1.25rem;width:85%}.card-headline[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%], .card-body-results-item[_ngcontent-%COMP%]{display:flex;background-color:#fff;padding:20px;box-shadow:0 4px 12px #0d0a2c0f;border:solid 1px #e6e6e9;width:90%}.card-headline[_ngcontent-%COMP%]{justify-content:center;align-items:center;border-radius:16px 16px 0 0;padding:1.75rem;width:90%}.card-body-headline[_ngcontent-%COMP%]{margin-bottom:1.25rem}.card-body[_ngcontent-%COMP%]{border-radius:0 0 16px 16px;justify-content:flex-start;flex-direction:column;height:30.75rem;overflow-y:auto}.card-body[_ngcontent-%COMP%]::-webkit-scrollbar{width:.25rem}.card-body[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:1rem}.card-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--dark-blue);border-radius:1rem}.card-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--darker-blue)}[_nghost-%COMP%]     .p-sidebar-active{width:50%;top:4rem}[_nghost-%COMP%]     .map-panel.p-panel .p-panel-content{padding:0}[_nghost-%COMP%]     .overlay.p-blockui{border-radius:1rem;width:25rem!important;height:15.625rem}.card-body-results-item[_ngcontent-%COMP%]{width:100%;justify-content:space-between;flex-direction:column;margin-bottom:1.25rem;border-radius:16px}.card-body-results-item[_ngcontent-%COMP%]   .result-item-body[_ngcontent-%COMP%]{cursor:pointer}.result-body-buttons[_ngcontent-%COMP%]{display:flex;align-self:flex-end}.result-body-buttons[_ngcontent-%COMP%]   .delete[_ngcontent-%COMP%]{position:relative;align-self:flex-end;background-color:#fff;padding:.25rem;box-shadow:0 4px 12px #0d0a2c0f;border:solid 1px #e6e6e9;border-radius:4px}.result-body-buttons[_ngcontent-%COMP%]   .delete[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1.25rem;height:1.25rem}.card-headline[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .card-body-headline[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .result-item-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--dark-gray)}.card-headline[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700}.card-body-headline[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .result-item-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem}.result-item-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:.313rem}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:.5rem 1rem;margin-top:1rem;border-radius:.25rem;cursor:pointer;box-shadow:0 0 .25rem #00000026;font-weight:700}.dialog-actions[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]{background-color:var(--white);color:var(--dark-blue);border:1px solid var(--dark-blue)}.dialog-actions[_ngcontent-%COMP%]   .confirm-btn[_ngcontent-%COMP%]{background-color:#f87171;color:var(--white)}.delete-dialog[_ngcontent-%COMP%]{position:fixed;z-index:1300}@media screen and (max-width: 1000px){[_nghost-%COMP%]     .p-sidebar-active{width:70%;height:calc(100vh - 8rem)}}@media screen and (max-width: 600px){[_nghost-%COMP%]     .p-sidebar-active{width:100%}}"]}),s})();function L(o,s){1&o&&(e.j41(0,"div",4),e.nrm(1,"app-today-schedule-widget",3),e.k0s())}function z(o,s){if(1&o){const a=e.RV6();e.j41(0,"app-modal",5),e.bIt("closed",function(){e.eBV(a);const n=e.XpG(2);return e.Njj(n.closeModal())}),e.k0s()}}function G(o,s){if(1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2),e.nrm(3,"app-appointment-filter",3),e.k0s(),e.DNE(4,L,2,0,"div",4),e.k0s(),e.DNE(5,z,1,0,"app-modal"),e.k0s()),2&o){const a=e.XpG();e.R7$(4),e.vxM(4,"admin"==a.user.role?4:-1),e.R7$(),e.vxM(5,a.showModal?5:-1)}}function H(o,s){1&o&&e.nrm(0,"app-spinner")}let W=(()=>{var o;class s{constructor(t,n){this._authService=t,this._toastService=n,this.isLoaded=!1,this.showModal=!1}ngOnInit(){this._authService.currentUser$.subscribe(t=>{t?(this.user=t,this.checkEmptyFields(t)):this._authService.getCurrentUser().then(n=>{this.user=n,this.checkEmptyFields(n)})})}ngOnDestroy(){this.isLoaded=!1,this.showModal=!1,this.user=null}checkEmptyFields(t){!function X(o){const s=["birthdate","email","name","lastname","identification","phoneNumber"];for(const a of s){const t=o[a];if("string"==typeof t&&""===t.trim())return!0}return!1}(t)?this.isLoaded=!0:(this._toastService.showWarning("Completa la informaci\xf3n de tu perfil"),this.isLoaded=!0,this.openModal())}openModal(){this.showModal=!0}closeModal(){this.showModal=!1}}return(o=s).\u0275fac=function(t){return new(t||o)(e.rXU(f.u),e.rXU(u.f))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-home"]],standalone:!0,features:[e.aNF],decls:2,vars:1,consts:[[1,"main-page"],[1,"widget-container"],[1,"widget-container-left"],[1,"w-full"],[1,"widget-container-right"],[3,"closed"]],template:function(t,n){1&t&&e.DNE(0,G,6,2,"div",0)(1,H,1,0),2&t&&e.vxM(0,n.isLoaded?0:1)},dependencies:[m.MD,S,R,$,_.t],styles:[".widget-container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;width:100%;height:calc(100vh - 4.875rem);opacity:0;animation:fadeInBackground .2s ease-in-out forwards}.widget-container-left[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-end;align-items:center;flex:2}.widget-container-right[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;flex:1}@media screen and (max-width: 1150px){.widget-container[_ngcontent-%COMP%]{flex-direction:column}.widget-container-left[_ngcontent-%COMP%]{justify-content:flex-start;margin-top:3rem;width:100%}.widget-container-right[_ngcontent-%COMP%]{display:none}.card-headline[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%], .card-body-results-item[_ngcontent-%COMP%]{width:100%}}@media screen and (max-width: 820px){.card-headline[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%], .card-body-results-item[_ngcontent-%COMP%]{width:100%;flex-direction:column}}@media screen and (max-width: 768px){.w-full[_ngcontent-%COMP%]{height:100%}}"]}),s})()},2423:(F,C,l)=>{l.d(C,{D:()=>M});var m=l(9842),c=l(4438),e=l(461);let M=(()=>{var _;class g extends e.h{}return _=g,(0,m.A)(g,"\u0275fac",(()=>{let f;return function(h){return(f||(f=c.xGo(_)))(h||_)}})()),(0,m.A)(g,"\u0275cmp",c.VBU({type:_,selectors:[["ChevronDownIcon"]],standalone:!0,features:[c.Vt3,c.aNF],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M7.01744 10.398C6.91269 10.3985 6.8089 10.378 6.71215 10.3379C6.61541 10.2977 6.52766 10.2386 6.45405 10.1641L1.13907 4.84913C1.03306 4.69404 0.985221 4.5065 1.00399 4.31958C1.02276 4.13266 1.10693 3.95838 1.24166 3.82747C1.37639 3.69655 1.55301 3.61742 1.74039 3.60402C1.92777 3.59062 2.11386 3.64382 2.26584 3.75424L7.01744 8.47394L11.769 3.75424C11.9189 3.65709 12.097 3.61306 12.2748 3.62921C12.4527 3.64535 12.6199 3.72073 12.7498 3.84328C12.8797 3.96582 12.9647 4.12842 12.9912 4.30502C13.0177 4.48162 12.9841 4.662 12.8958 4.81724L7.58083 10.1322C7.50996 10.2125 7.42344 10.2775 7.32656 10.3232C7.22968 10.3689 7.12449 10.3944 7.01744 10.398Z","fill","currentColor"]],template:function(u,h){1&u&&(c.qSk(),c.j41(0,"svg",0),c.nrm(1,"path",1),c.k0s()),2&u&&(c.HbH(h.getClassNames()),c.BMQ("aria-label",h.ariaLabel)("aria-hidden",h.ariaHidden)("role",h.role))},encapsulation:2})),g})()}}]);