"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[695],{9695:(b,_,a)=>{a.r(_),a.d(_,{UserProfileComponent:()=>y});var o=a(467),m=a(2575),h=a(9132),C=a(1517),e=a(4438),c=a(7927),f=a(5889),u=a(4441),l=a(2107);let p=(()=>{var s;class d{constructor(t){this._storage=t}getFileUrl(t){var n=this;return(0,o.A)(function*(){const r=(0,l.KR)(n._storage,t);return(0,l.qk)(r)})()}uploadFile(t,n){var r=this;return(0,o.A)(function*(){try{const g=(0,l.KR)(r._storage,n),v=yield(0,l.D)(g,t);return yield(0,l.qk)(v.ref)}catch(g){return Promise.reject(g)}})()}deleteFile(t){var n=this;return(0,o.A)(function*(){const r=(0,l.KR)(n._storage,t);return(0,l.XR)(r)})()}}return(s=d).\u0275fac=function(t){return new(t||s)(e.KVO(l.wc))},s.\u0275prov=e.jDH({token:s,factory:s.\u0275fac,providedIn:"root"}),d})();var x=a(2185);const P=["fileInput"];function O(s,d){if(1&s){const i=e.RV6();e.j41(0,"button",20),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2);return e.Njj(n.onEditModeChanged(!n.inputsEditable))}),e.nrm(1,"img",21),e.j41(2,"span",22),e.EFF(3,"Editar mis datos"),e.k0s()(),e.j41(4,"button",23),e.bIt("click",function(){e.eBV(i);const n=e.XpG(2);return e.Njj(n.openDialog())}),e.nrm(5,"img",24),e.j41(6,"span",25),e.EFF(7,"Eliminar mi cuenta"),e.k0s()()}}function M(s,d){if(1&s){const i=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5),e.nrm(4,"img",6),e.j41(5,"button",7),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.onButtonClick())}),e.k0s()(),e.j41(6,"div",8)(7,"h3",9),e.EFF(8),e.k0s(),e.j41(9,"h4",9),e.EFF(10),e.k0s()()(),e.j41(11,"div",10)(12,"input",11,0),e.bIt("change",function(n){e.eBV(i);const r=e.XpG();return e.Njj(r.onFileSelected(n))}),e.k0s(),e.DNE(14,O,8,0),e.k0s()(),e.j41(15,"app-user-info-form",12),e.bIt("userInfo",function(n){e.eBV(i);const r=e.XpG();return e.Njj(r.onUserInfoUpdate(n))})("editModeChanged",function(n){e.eBV(i);const r=e.XpG();return e.Njj(r.onEditModeChanged(n))}),e.k0s()(),e.j41(16,"app-dialog",13),e.bIt("closeDialog",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.handleDialogClose())}),e.j41(17,"div",14)(18,"h2"),e.EFF(19,"Eliminar cuenta"),e.k0s()(),e.j41(20,"div",15)(21,"div",16)(22,"p"),e.EFF(23,"\xbfEst\xe1s seguro que deseas eliminar tu cuenta?"),e.k0s()(),e.j41(24,"div",17)(25,"button",18),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.handleDialogClose())}),e.EFF(26,"Cancelar"),e.k0s(),e.j41(27,"button",19),e.bIt("click",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.onUserDelete())}),e.EFF(28,"Eliminar"),e.k0s()()()()}if(2&s){const i=e.XpG();e.R7$(4),e.FS9("src",(null==i.user?null:i.user.photoURL)||"/assets/icon/user_icon.svg",e.B4B),e.R7$(4),e.Lme("",null==i.user?null:i.user.name," ",null==i.user?null:i.user.lastname,""),e.R7$(2),e.JRh(null==i.user?null:i.user.email),e.R7$(4),e.vxM(14,i.inputsEditable?-1:14),e.R7$(),e.Y8G("isEditable",i.inputsEditable),e.R7$(),e.Y8G("isOpen",i.isDialogOpen)}}function k(s,d){1&s&&e.nrm(0,"app-spinner")}let y=(()=>{var s;class d{constructor(t,n,r,g,v){this._userService=t,this._toastService=n,this._authService=r,this._storageService=g,this._router=v,this.inputsEditable=!1,this.isLoaded=!1,this.isDialogOpen=!1,this.user=null}ngOnInit(){this._authService.currentUser$.subscribe(t=>{t?this.user=t:this._authService.getCurrentUser(),this.isLoaded=!0})}onButtonClick(){this.fileInput?this.fileInput.nativeElement.click():console.error("File input is not available.")}onFileSelected(t){var n;const r=t.target;null!=r&&null!==(n=r.files)&&void 0!==n&&n[0]?this.handleFile(r.files[0]):console.error("No file selected or file input is null.")}handleFile(t){this.user&&this._storageService.uploadFile(t,`hpl_users/${this.user.uid}`).then(n=>{this.user.photoURL=n,this._userService.updateUser(this.user.uid,this.user).then(()=>{this._authService.getCurrentUser(),this._toastService.showSuccess("Imagen subida correctamente")})}).catch(n=>{console.log(n),this._toastService.showError("Error al subir la imagen")})}onEditModeChanged(t){this.inputsEditable=t}onUserInfoUpdate(t){this.user&&this._userService.updateUserDB(t,this.user.uid).then(n=>{n.error&&this._toastService.showError("Error al actulaizar la informaci\xf3n"),this._toastService.showSuccess("Datos actualizados correctamente"),this.inputsEditable=!this.inputsEditable})}onUserDelete(){var t=this;return(0,o.A)(function*(){try{yield t._authService.deleteUserAccount(t.user.uid).then((0,o.A)(function*(){yield t._userService.deleteUser(t.user.uid),yield t._authService.signOut().then(()=>{t._router.navigate(["/auth/login"]),t._toastService.showSuccess("Usuario eliminado correctamente")})}))}catch{t._toastService.showError("Error al eliminar el usuario")}})()}openDialog(){this.isDialogOpen=!0}handleDialogClose(){this.isDialogOpen=!1}}return(s=d).\u0275fac=function(t){return new(t||s)(e.rXU(c.D),e.rXU(f.f),e.rXU(u.u),e.rXU(p),e.rXU(x.Ix))},s.\u0275cmp=e.VBU({type:s,selectors:[["app-user-profile"]],viewQuery:function(t,n){if(1&t&&e.GBs(P,5),2&t){let r;e.mGM(r=e.lsd())&&(n.fileInput=r.first)}},standalone:!0,features:[e.aNF],decls:3,vars:1,consts:[["fileInput",""],[1,"full-screen-container"],[1,"flex-container"],[1,"container-header"],[1,"profile-data"],[1,"profile-picture"],["alt","Profile Photo",3,"src"],["id","fileButton",1,"new-photo-btn",3,"click"],[1,"user-data"],[1,"text-gray"],[1,"actions"],["type","file","accept","image/*",2,"display","none",3,"change"],[3,"userInfo","editModeChanged","isEditable"],[1,"delete-dialog",3,"closeDialog","isOpen"],["dialog-header",""],["dialog-body",""],[1,"content-body"],[1,"dialog-actions"],[1,"btn","cancel-btn",3,"click"],[1,"btn","confirm-btn",3,"click"],[1,"edit-btn",3,"click"],["src","/assets/icon/pencil.svg","alt","edit"],[1,"edit-tooltip-text"],[1,"delete-btn",3,"click"],["src","/assets/icon/trash-can-alt.svg","alt","delete"],[1,"delete-tooltip-text"]],template:function(t,n){1&t&&(e.j41(0,"div",1),e.DNE(1,M,29,7)(2,k,1,0),e.k0s()),2&t&&(e.R7$(),e.vxM(1,n.isLoaded?1:2))},dependencies:[h.l,C.t,m.m],styles:[".full-screen-container[_ngcontent-%COMP%]{position:fixed;top:4rem;left:0;width:100%;height:100%;overflow-y:auto;animation:fadeInBackground .2s ease-in-out forwards}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:2rem}.container-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:3rem;margin-top:4rem}.profile-data[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;gap:1rem}.profile-data[_ngcontent-%COMP%]   .profile-picture[_ngcontent-%COMP%]{position:relative;display:inline-block}.profile-data[_ngcontent-%COMP%]   .new-photo-btn[_ngcontent-%COMP%]{background-color:#fff;padding:1rem;box-shadow:0 4px 12px #0d0a2c0f;border:solid .063rem #e6e6e9;border-radius:1rem;position:absolute;bottom:.313rem;left:4.375rem;background-image:url(/assets/icon/new_photo_icon.svg);background-repeat:no-repeat;background-position:center;background-size:20px 20px}.profile-data[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:6.25rem;height:6.25rem;border-radius:3.125rem;object-fit:cover}.text-gray[_ngcontent-%COMP%]{color:var(--dark-gray)}.actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center}.actions[_ngcontent-%COMP%]   .edit-btn[_ngcontent-%COMP%], .actions[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{display:flex;justify-content:center;position:relative;background-color:#fff;padding:.25rem;box-shadow:0 4px 12px #0d0a2c0f;border:solid 1px #e6e6e9;border-radius:4px;margin:1rem;flex:1}.actions[_ngcontent-%COMP%]   .edit-btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .actions[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1.25rem;height:1.25rem}.edit-tooltip-text[_ngcontent-%COMP%], .delete-tooltip-text[_ngcontent-%COMP%]{visibility:hidden;position:absolute;bottom:calc(100% + .25rem);left:50%;transform:translate(-50%);background-color:#333;color:#fff;padding:5px;border-radius:6px;z-index:1;width:max-content}.actions[_ngcontent-%COMP%]   .edit-btn[_ngcontent-%COMP%]:hover   .edit-tooltip-text[_ngcontent-%COMP%], .actions[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]:hover   .delete-tooltip-text[_ngcontent-%COMP%]{visibility:visible}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:.5rem 1rem;margin-top:1rem;border-radius:.25rem;cursor:pointer;box-shadow:0 0 .25rem #00000026;font-weight:700}.dialog-actions[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]{background-color:var(--white);color:var(--dark-blue);border:1px solid var(--dark-blue)}.dialog-actions[_ngcontent-%COMP%]   .confirm-btn[_ngcontent-%COMP%]{background-color:#f87171;color:var(--white)}.delete-dialog[_ngcontent-%COMP%]{position:fixed;z-index:1300}@media screen and (max-width: 1150px){.full-screen-container[_ngcontent-%COMP%]{position:unset;top:unset;left:unset;height:86vh}.profile-data[_ngcontent-%COMP%]{margin:unset;flex-direction:column;gap:1rem}.profile-data[_ngcontent-%COMP%]   .user-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.container-header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;margin-top:1rem}.actions[_ngcontent-%COMP%]   .edit-btn[_ngcontent-%COMP%]:hover   .edit-tooltip-text[_ngcontent-%COMP%], .actions[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]:hover   .delete-tooltip-text[_ngcontent-%COMP%]{visibility:hidden}}"]}),d})()},2575:(b,_,a)=>{a.d(_,{m:()=>e});var o=a(4438);const m=[[["","dialog-header",""]],[["","dialog-body",""]]],h=["[dialog-header]","[dialog-body]"];function C(c,f){if(1&c){const u=o.RV6();o.j41(0,"div",0)(1,"div",1),o.bIt("click",function(){o.eBV(u);const p=o.XpG();return o.Njj(p.dismiss())}),o.k0s(),o.j41(2,"div",2)(3,"div",3),o.SdG(4),o.j41(5,"button",4),o.bIt("click",function(){o.eBV(u);const p=o.XpG();return o.Njj(p.dismiss())}),o.EFF(6,"\xd7"),o.k0s()(),o.j41(7,"div",5),o.SdG(8,1),o.k0s()()()}}let e=(()=>{var c;class f{constructor(){this.isOpen=!1,this.closeDialog=new o.bkB}ngOnInit(){}dismiss(){this.isOpen=!1,this.closeDialog.emit()}}return(c=f).\u0275fac=function(l){return new(l||c)},c.\u0275cmp=o.VBU({type:c,selectors:[["app-dialog"]],inputs:{isOpen:"isOpen"},outputs:{closeDialog:"closeDialog"},standalone:!0,features:[o.aNF],ngContentSelectors:h,decls:1,vars:1,consts:[[1,"dialog"],[1,"dialog-overlay",3,"click"],[1,"dialog-content"],[1,"dialog-header"],[1,"close-button",3,"click"],[1,"dialog-body"]],template:function(l,p){1&l&&(o.NAR(m),o.DNE(0,C,9,0,"div",0)),2&l&&o.vxM(0,p.isOpen?0:-1)},styles:[".dialog[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background-color:#00000080}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:1.25rem;font-weight:700;color:var(--dark-blue)}.dialog-body[_ngcontent-%COMP%]{padding:20px;background-color:#fff;border-radius:8px}.dialog-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:transparent}.dialog-content[_ngcontent-%COMP%]{position:relative;background:#fff;border-radius:8px;padding:20px;max-height:650px;box-shadow:0 2px 10px #0000001a;z-index:1200}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.close-button[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer}@media screen and (min-width: 1750px){.dialog-content[_ngcontent-%COMP%]{max-height:880px}}"]}),f})()}}]);